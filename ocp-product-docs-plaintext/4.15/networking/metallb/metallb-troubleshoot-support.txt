MetalLB logging, troubleshooting, and support

If you need to troubleshoot MetalLB configuration, see the following sections for commonly used commands.
Setting the MetalLB logging levels
MetalLB uses FRRouting (FRR) in a container with the default setting of info generates a lot of logging. You can control the verbosity of the logs generated by setting the logLevel as illustrated in this example.

Gain a deeper insight into MetalLB by setting the logLevel to debug as follows:

You have access to the cluster as a user with the cluster-admin role.

You have installed the OpenShift CLI (oc).


Create a file, such as setdebugloglevel.yaml, with content like the following example:

Apply the configuration:

Display the names of the speaker pods:

View the speaker logs:

View the FRR logs:


FRRouting (FRR) log levels
The following table describes the FRR logging levels.
Troubleshooting BGP issues
The BGP implementation that Red Hat supports uses FRRouting (FRR) in a container in the speaker pods. As a cluster administrator, if you need to troubleshoot BGP configuration issues, you need to run commands in the FRR container.

You have access to the cluster as a user with the cluster-admin role.

You have installed the OpenShift CLI (oc).


Display the names of the speaker pods:

Display the running configuration for FRR:

Display the BGP summary:

Display the BGP peers that received an address pool:
Troubleshooting BFD issues
The Bidirectional Forwarding Detection (BFD) implementation that Red Hat supports uses FRRouting (FRR) in a container in the speaker pods. The BFD implementation relies on BFD peers also being configured as BGP peers with an established BGP session. As a cluster administrator, if you need to troubleshoot BFD configuration issues, you need to run commands in the FRR container.

You have access to the cluster as a user with the cluster-admin role.

You have installed the OpenShift CLI (oc).


Display the names of the speaker pods:

Display the BFD peers:
MetalLB metrics for BGP and BFD
Red Hat OpenShift Container Platform captures the following metrics for MetalLB that relate to BGP peers and BFD profiles.



See Querying metrics for information about using the monitoring dashboard.
About collecting MetalLB data
You can use the oc adm must-gather CLI command to collect information about your cluster, your MetalLB configuration, and the MetalLB Operator. The following features and objects are associated with MetalLB and the MetalLB Operator:

The namespace and child objects that the MetalLB Operator is deployed in

All MetalLB Operator custom resource definitions (CRDs)


The oc adm must-gather CLI command collects the following information from FRRouting (FRR) that Red Hat uses to implement BGP and BFD:

/etc/frr/frr.conf

/etc/frr/frr.log

/etc/frr/daemons configuration file

/etc/frr/vtysh.conf


The log and configuration files in the preceding list are collected from the frr container in each speaker pod.

In addition to the log and configuration files, the oc adm must-gather CLI command collects the output from the following vtysh commands:

show running-config

show bgp ipv4

show bgp ipv6

show bgp neighbor

show bfd peer


No additional configuration is required when you run the oc adm must-gather CLI command.

Gathering data about your cluster