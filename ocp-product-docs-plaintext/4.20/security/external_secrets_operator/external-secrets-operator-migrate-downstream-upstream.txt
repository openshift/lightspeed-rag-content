# Migrating from the community External Secrets Operator to External Secrets Operator for Red Hat OpenShift


You can migrate from the community version of the External Secrets Operator. Migrating to External Secrets Operator for Red Hat OpenShift provides you with an officially supported product giving you access to enterprise-grade support. It also provides you with seamless integration from installation to upgrades.
The following migration versions have been fully tested.


[NOTE]
----
The migration does not support rollbacks.
----

[NOTE]
----
External Secrets Operator for Red Hat OpenShift is based on the upstream version 0.19.0. Do not attempt to migrate from a higher version of the External Secrets Operator.
----

# Deleting the community External Secrets Operator

You must delete the operatorconfigs.operator.external-secrets.io custom resource (CR) for the community External Secrets Operator to delete the external-secrets application installed by the community External Secrets Operator.

* You must be logged in as a user with the cluster-admin role.
* You must have the oc command-line tool installed and configured.

1. Find your community Operator's namespace by running the following command:

```terminal
$ oc get operatorconfigs.operator.external-secrets.io -A
```


The following is an example of finding the namespace:

```terminal
NAMESPACE             NAME        AGE
external-secrets      cluster     9m18s
```

2. Delete the operatorconfig by running the following command:

```terminal
$ oc delete operatorconfig <config_name> -n <operator_namespace>
```


1. To verify that the operatorconfig was deleted, run the following command:

```terminal
$ oc get operatorconfig -n <operator_namespace>
```


The command must return no resource found.
2. To verify that the old webhooks are deleted, run the following commands:

```terminal
$ oc get validatingwebhookconfigurations | grep external-secrets
```


```terminal
$ oc get mutatingwebhookconfigurations | grep external-secrets
```


The commands must return no results.

# Uninstalling the community External Secrets Operator

You must uninstall the community External Secrets Operator to prevent it from being recreated or conflicting with the new one.

* You must be logged in as a user with the cluster-admin role.
* You must have deleted the operatorconfig.

1. If you installed the community External Secrets Operator by an Operator Lifecycle Manager (OLM) subscription, delete the Operator by performing the following steps:
1. Find the subscription name by running the following command:

```terminal
$ oc get subscription -n <operator_namespace> | grep external-secrets
```

2. Delete the subscription by running the following command:

```terminal
$ oc delete subscription <subscription_name> -n <operator_namespace>
```

3. Delete the ClusterServiceVersion by running the following command:

```terminal
$ oc delete csv <csv_name> -n <operator_namespace>
```

2. If you installed the community {external-secret-operator} by Helm, delete the Operator by running the following command:

```terminal
$ helm uninstall <release_name> -n <operator_namespace>
```

3. If you installed the community {external-secret-operator} by raw manifests, delete the Operator by running the following command:

```terminal
$ oc delete -f /path/to/your/old/manifests.yaml -n <operator_namespace>
```


# Installing the External Secrets Operator for Red Hat OpenShift

Once the operatorconfig has been deleted and the community {external-secret-operator-short} has been deleted, you can install the External Secrets Operator for Red Hat OpenShift. For more information, see Installing the External Secrets Operator for Red Hat OpenShift.

# Creating the ExternalSecretsConfig Operator

The purpose of creating the ExternalSecretsConfig is to install and configure the external-secrets. The configuration ensures that cert-manager and Bitwarden support are enabled.

* External Secrets Operator for Red Hat OpenShift is installed.
* cert-manager Operator for Red Hat OpenShift is installed.
* You have access to the cluster with cluster-admin privileges.

1. Create an externalsecretsconfig file by defining a YAML file with the following content:

```yml
apiVersion: operator.openshift.io/v1alpha1
kind: ExternalSecretsConfig
metadata:
  labels:
    app.kubernetes.io/name: cluster
  name: cluster
spec:
  appConfig:
    logLevel: 3
  webhookConfig:
    certificateCheckInterval: 5m0s
  controllerConfig:
    certProvider:
      certManager:
        certificateDuration: 8760h0m0s
        certificateRenewBefore: 30m0s
        injectAnnotations: "true"
        issuerRef:
          group: cert-manager.io
          kind: Issuer
          name: _<created_issuer_name>_
    mode: Enabled
    networkPolicies:
    - componentName: ExternalSecretsCoreController
      egress:
      - ports:
        - port: 443
          protocol: TCP
        - port: 9998
          protocol: TCP
        name: allow-external-secrets-egress
    plugins:
      bitwardenSecretManagerProvider:
        mode: Enabled
```

2. Create the ExternalSecretsConfig object by running the following command:

```terminal
$ oc create -f externalsecretsconfig.yaml
```


Verify that all custom resources (CRs) are present and that the APIs are using v1 instead of v1beta1. There CRs are retained and automatically converted by the new Operator.

1. To verify that the external-secrets pods are in a running state, run the following command:

```terminal
$ oc get pods -n external-secret
```


The following is example output that the external-secrets pods are in a running state

```terminal
NAME                                          READY        STATUS        RESTARTS     AGE
bitwarden-sdk-server-5b4cf48766-w7zp7         1/1          Running       0            5m
external-secrets-5854b85dd5-m6zf9             1/1          Running       0            5m
external-secrets-webhook-5cb85b8fdb-6jtqb     1/1          Running       0            5m
```

2. To verify that the SecretStore CR is present, run the following command:

```terminal
$ oc get secretstores.external-secrets.io -A
```


The following is example output from validating that the SecretStore is present:

```terminal
NAMESPACE               NAME                         AGE         STATUS      CAPABILITIES    READY
external-secrets-1      gcp-store                    18min       Valid       ReadWrite       True
external-secrets-2      aws-secretstore              11min       Valid       ReadWrite       True
external-secrets        bitwarden-secretsmanager     20min       Valid       Readwrite       True
```

3. To verify that the ExternalSecret CR is present, run the following command:

```terminal
$ oc get externalsecrets.external-secrets.io -A
```


The following is example output from validating that the SecretStore is present:

```terminal
NAMESPACE             NAME                    STORE                      REFRESH INTERVAL    STATUS          READY
external-secrets-1    gcp-externalsecret      gcp-store                  1hr                 SecretSynced    True
external-secrets-2    aws-external-secret     aws-secret-store           1hr                 SecretSynced    True
external-secrets      bitwarden               bitwarden-secretsmanager   1hr                 SecretSynced    True
```

4. To verify that the SecretStore is apiVersion: external-secrets.io/v1, run the following command:

```terminal
$ oc get secretstores.external-secrets.io -n external-secrets-1 gcp-store -o yaml
```


The following is example output that the SecretStore is apiVersion: external-secrets.io/v1.

```yml
apiVersion: external-secrets.io/v1
kind: SecretStore
metadata:
  creationTimestamp: "2025-10-27T11:38:19Z"
  generation: 1
  name: gcp-store
  namespace: external-secrets-1
  resourceVersion: "104519"
  uid: 7bccb0cc-2557-4f4a-9caa-1577f0108f4b
spec:
.
.
.
status:
  capabilities: ReadWrite
  conditions:
  - lastTransitionTime: "2025-10-27T11:38:19Z"
    message: store validated
    reason: Valid
    status: "True"
    type: Ready
```

5. To verify that the ExternalSecret is apiVersion: external-secrets.io/v1, run the following command:

```terminal
$ oc get externalsecrets.external-secrets.io -n external-secrets-1 gcp-externalsecret -o yaml
```


The following is example output that the ExternalSecret is apiVersion: external-secrets.io/v1.

```yml
apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  creationTimestamp: "2025-10-27T11:39:03Z"
  generation: 1
  name: gcp-externalsecret
  namespace: external-secrets-1
  resourceVersion: "104532"
  uid: 93a3295a-a3ad-4304-90e1-1328d951e5fb
spec:
.
.
.
status:
  binding:
    name: k8s-secret-gcp
  conditions:
  - lastTransitionTime: "2025-10-27T11:39:03Z"
    message: secret synced
    reason: SecretSynced
    status: "True"
    type: Ready
  refreshTime: "2025-10-27T12:13:15Z"
  syncedResourceVersion: 1-f47fe3c0b255b6dd8047cdffa772587bb829efe7a1cb70febeda2eb2
```
