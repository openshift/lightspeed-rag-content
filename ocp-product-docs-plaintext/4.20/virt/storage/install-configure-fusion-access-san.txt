# Using OpenShift Virtualization with IBM Fusion Access for SAN



# About IBM Fusion Access for SAN

IBM Fusion Access for SAN provides a scalable clustered file system for enterprise storage, primarily designed to offer access to consolidated, block-level data storage. It presents storage devices, such as disk arrays, to the operating system as if they were direct-attached storage.

This solution is particularly geared towards enterprise storage for OpenShift Virtualization and leverages existing Storage Area Network (SAN) infrastructure. A SAN is a dedicated network of storage devices that is typically not accessible through the local area network (LAN).

To use OpenShift Virtualization with IBM Fusion Access for SAN, you must first install the Fusion Access for SAN Operator.

Then you must create a Kubernetes pull secret and create the FusionAccess custom resource (CR).

Finally, follow the {product-title} web console wizard to configure the storage cluster, local disk, and file systems.

## Why use Fusion Access for SAN?

Easy user experience:: Fusion Access for SAN features a wizard-driven user interface (UI) for installing and configuring storage clusters, file systems, and storage classes, to simplify the setup process.
Leverage existing infrastructure:: Organizations can leverage their existing SAN investments, including Fibre Channel (FC) and iSCSI technologies, as they transition to or expand with OpenShift Virtualization.
Scalability:: The storage cluster is designed to scale with {product-title} clusters and virtual machine (VM) workloads. It can support up to approximately 3000 VMs on 6 bare-metal hosts, with possibilities for further scaling by adding more file systems or using specific storage class parameters.
Consolidated and shared storage:: SANs enable multiple servers to access a large, shared data storage capacity. This architecture facilitates automatic data backup and continuous monitoring of the storage and backup processes.
High-speed data transfer:: By using a dedicated high-speed network for storage, Fusion Access for SAN overcomes the data transfer bottlenecks that can occur over a traditional LAN, especially for large volumes of data.
File-level access:: Although a SAN primarily operates at the block level, file systems built on top of SAN storage can provide file-level access through shared-disk file systems.
Centralized management:: The underlying SAN software manages servers, storage devices, and the network to ensure that data moves directly between storage devices with minimal server intervention. It also supports centralized management and configuration of SAN components like Logical Unit Numbers (LUNs).

# Prerequisites and Limitations for Fusion Access for SAN

## Prerequisites

Installing and configuring Fusion Access for SAN require the following prerequisites:

* Bare-metal worker nodes with attached SAN storage.
* A working container registry enabled.
* All worker nodes must connect to the same LUNs.

A shared LUN is a shared disk that is accessed by all worker nodes simultaneously.
* A Kubernetes pull secret.

## Limitations

* Limitations for Fusion Access for SAN rely on the IBM Storage Scale container native limitations and can be found in the documentation for IBM Storage Scale container native.
* Hosted control planes (HCP) clusters are not supported.

# Installing the Fusion Access for SAN Operator

You can install the Fusion Access for SAN Operator from the software catalog in the {product-title} web console.

* You have access to the cluster as a user with the cluster-admin role.
* You have a working container registry enabled.

1. In the {product-title} web console, navigate to Ecosystem -> Software Catalog.
2. In the Filter by keyword field, type Fusion Access for SAN.
3. Select the Fusion Access for SAN tile and click Install.
4. On the Install Operator page, keep the default selections for Update Channel, Version, and Installation mode.
5. Verify that Operator recommended Namespace is selected for Installed Namespace.

This installs the Operator in the ibm-fusion-access namespace. If this namespace does not yet exist, it is automatically created.

[WARNING]
----
You must install the Fusion Access for SAN Operator in the ibm-fusion-access namespace. Installation in any other namespace is not supported.
----
6. Verify that the Automatic default is selected for Update Approval.

This enables automatic updates when a new z-stream release is available.
7. Click Install.

This installs the Operator.

1. Navigate to Ecosystem -> Installed Operators.
2. Verify that the Fusion Access for SAN Operator is displayed.

# Creating a Kubernetes pull secret

After installing the Fusion Access for SAN Operator, you must create a Kubernetes secret object to hold the IBM entitlement key for pulling the required container images from the IBM container registry.

* You installed the oc CLI.
* You have access to the cluster as a user with the cluster-admin role.
* You installed the Fusion Access for SAN Operator and created the ibm-fusion-access namespace in the process.

1. Log in to the IBM Container software library with your Fusion Access for SAN IBMid and password.
2. In the IBM Container software library, get the entitlement key:
1. If you do not have an entitlement key yet, click Get entitlement key or Add new key, and then click Copy.
2. If you already have an entitlement key, click Copy.
3. Save the entitlement key in a safe place.
4. Create the secret object by running the oc create command:

```terminal
$ oc create secret -n ibm-fusion-access generic fusion-pullsecret \
--from-literal=ibm-entitlement-key=<ibm-entitlement-key> 1
```

This is the entitlement key you copied in step 2 from the IBM Container software library.

1. In the {product-title} web console, navigate to Workloads -> Secrets.
2. Find the fusion-pullsecret in the list.

# Creating the FusionAccess CR

After installing the Fusion Access for SAN Operator and creating a Kubernetes pull secret, you must create the FusionAccess custom resource (CR).

Creating the FusionAccess CR triggers the installation of the correct version of IBM Storage Scale and detects worker nodes with shared LUNs.

* You have access to the cluster as a user with the cluster-admin role.
* You installed the Fusion Access for SAN Operator.
* You created a Kubernetes pull secret.

1. In the {product-title} web console, navigate to Ecosystem -> Installed Operators.
2. Click on the Fusion Access for SAN Operator you installed.
3. In the Fusion Access for SAN page, select the Fusion Access tab.
4. Click Create FusionAccess.
5. On the Create FusionAccess page, enter the object Name.
6. Optional: You can choose to add Labels if they are relevant.
7. Select the IBM Storage Scale Version from the drop-down list.
8. Click Create.

* In the Fusion Access for SAN Operator page, in the Fusion Access tab, verify that the created FusionAccess CR appears with the status Ready.

# Creating a storage cluster with Fusion Access for SAN

Once you have installed the Fusion Access for SAN Operator, you can create a storage cluster with shared storage nodes.

The wizard for creating the storage cluster in the {product-title} web console provides easy-to-follow steps and lists the relevant worker nodes with shared disks.

* You have bare-metal worker nodes with visible and attached shared LUNs.

A shared LUN is a shared disk that is accessed by all workers simultaneously.
* You installed the Fusion Access for SAN Operator.
* You created the FusionAccess custom resource (CR) in the ibm-fusion-access namespace.

1. In the {product-title} web console, navigate to Storage -> Fusion Access for SAN.
2. Click Create storage cluster.
3. Select the worker nodes that have shared LUNs.

[NOTE]
----
You can only select worker nodes with a minimum of 20 GB of RAM from the list.
----
4. Click Create storage cluster.

The page reloads, opening the Fusion Access for SAN page for the new storage cluster.

# Creating a file system with Fusion Access for SAN

You need to create a file system to represent your required storage.

The file system is based on the storage available in the worker nodes you selected when creating the storage cluster.

* You created a Fusion Access for SAN storage cluster.

1. In the {product-title} web console, navigate to Storage -> Fusion Access for SAN.
2. In the File systems tab, click Create file system.
3. Enter a Name for the new file system.
4. Select the LUNs that you want to use as the storage volumes for your file system.
5. Click Create file system.

The Fusion Access for SAN page reloads, and the new file system appears in the File systems tab.

Repeat this procedure for each file system that you want to create.

1. Watch the Status of the file system in the File systems tab until it is marked as Healthy.

[NOTE]
----
This may take several minutes.
----
2. Click on the StorageClass for the file system.
3. In the YAML tab, verify the following:
1. The value in the name field is the name of the file system you created.
2. The value in the provisioner field is spectrumscale.csi.ibm.com.
3. The value in the volBackendFs field matches the name of the file system you created.

```yaml
kind: StorageClass
apiVersion: storage.k8s.io/v1
metadata:
  name: filesystem1
  uid: eb410309-a043-a89b-9bb05483872a
  resourceVersion: '87746'
  creationTimestamp: '2025-05-14T12:30:08Z'
  managedFields:
provisioner: spectrumscale.csi.ibm.com
parameters:
  volBackendFs: filesystem1
reclaimPolicy: Delete
allowVolumeExpansion: true
volumeBindingMode: Immediate
```


# Troubleshooting IBM Fusion Access for SAN

If you encounter issues with IBM Fusion Access for SAN, provide the must-gather image to Red&#160;Hat support. This image contains critical data about your cluster and project resources, logs, and events from your deployment.

1. To obtain the deployed version of IBM Fusion Access for SAN, run the following command:

```terminal
$ oc get fusionaccesses.fusion.storage.openshift.io  -n ibm-fusion-access fusionaccess-sample -o jsonpath='{.spec.storageScaleVersion}'
```


[NOTE]
----
This command returns the numeric value of the deployed version of IBM Fusion Access for SAN such as 2.11.0.
----
2. To create the must-gather image, run the following command:

```terminal
$ oc adm must-gather --image=icr.io/cpopen/ibm-spectrum-scale-must-gather:v<software_version>
```

* Replace <software_version> with the IBM Fusion Access for SAN version value.

# Next steps

Once you create a storage cluster with file systems, you can create a virtual machine (VM) on the storage cluster.

Create a VM from an instance type or template and select a storage class that corresponds to one of the file systems you created as the storage type.

* Creating virtual machines from instance types.
* Creating virtual machines from templates.

# IBM Fusion Access for SAN release updates

Release updates for IBM Fusion Access for SAN, including new features, bug fixes, and known issues.

## New and changed features

Fusion Access for SAN 1.1.0 includes Spectrum Scale 5.2.3.5:: Fusion Access for SAN 1.1.0 uses Spectrum Scale version 5.2.3.5. When you upgrade to Fusion Access for SAN 1.1.0, Spectrum Scale is automatically upgraded to version 5.2.3.5.

OCPNAS-294

OCPNAS-279
Image registry requirements for kernel module management:: IBM Fusion Access for SAN uses the {product-title} image registry to manage the kernel module. Do not configure the registry to use emptyDir storage because it provides only temporary storage and is not suitable for production use. Configure IBM Fusion Access for SAN to use a different image registry by creating a config map and secret after installing the Operator and before creating the FusionAccess CR.

OCPNAS-213

## Bug fixes

Filesystem creation button stays disabled until daemons are ready:: The IBM Fusion Access for SAN Operator was updated to check the readiness of filesystem daemons before allowing a filesystem to be created. The Create file system button in the web console now stays disabled with a tooltip explaining the condition until the environment is ready. This change prevents filesystems from appearing stuck during creation.

OCPNAS-184
Filesystems cannot be deleted from the user interface:: The {product-title} web console does not support deleting filesystems. To delete a filesystem, use the OpenShift CLI (`oc`).

OCPNAS-217

## Known issues

Filesystem creation might fail during core pod deletion:: Filesystem creation might fail if core pods are deleted at the same time. The filesystem might be partially created on the LUN, which results in the following persistent error:

```terminal
Disk <ID> may still belong to an active file system
```


No workaround is available. Contact IBM Support for assistance.

OCPNAS-233