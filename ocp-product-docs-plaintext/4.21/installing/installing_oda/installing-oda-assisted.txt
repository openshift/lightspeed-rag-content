# Installing a cluster on Oracle Database Appliance by using the Assisted Installer


You can use the Assisted Installer to install a cluster on Oracle Database Appliance (ODA).

# Preparing the Oracle Database Appliance environment

Before you can deploy an Red Hat OpenShift Container Platform cluster on Oracle Database Appliance (ODA), you must prepare the ODA environment.

* You have reviewed the requirements and additional prerequisites described in section 1 of the Red Hat Red Hat OpenShift Container Platform on Oracle Database Appliance Deployment Guide (Oracle documentation).

1. Complete the pre-deployment tasks as described in section 2 of the "Red Hat Red Hat OpenShift Container Platform on Oracle Database Appliance Deployment Guide".
2. Complete the final environment preparations as described in sections 3.1 and 3.2 of the "Red Hat Red Hat OpenShift Container Platform on Oracle Database Appliance Deployment Guide".

# Beginning the cluster installation and generating the Discovery ISO

Begin installing the Red Hat OpenShift Container Platform cluster in the Oracle Database Appliance (ODA) environment by using the Red Hat Hybrid Cloud Console.

1. Log in to the Red Hat Hybrid Cloud Console.
2. On the Cluster List page, click Create cluster.
3. Click the Datacenter tab.
4. Under Assisted Installer, click Create cluster.
5. Configure your cluster on the Cluster details page:
1. Enter a name for the cluster in the Cluster name field.
2. Enter a base domain for the cluster in the Base domain field.
All subdomains for the cluster will use this base domain.

[NOTE]
----
The base domain must be a valid DNS name.
You must not have a wildcard domain set up for the base domain.
----
3. Select a version from the OpenShift version dropdown list.
By default, the dropdown list displays the latest version.
4. Optional: In the Number of control plane nodes field, select the number of control plane nodes for your installation from the dropdown menu.
The default value is 3.
5. Optional: Select the Include custom manifests checkbox if you want to upload custom manifests to further configure your cluster.
This option adds an additional page for custom manifests that you use later in the configuration process.

[IMPORTANT]
----
If you have already added custom manifests, clearing the Include custom manifests checkbox automatically deletes them all.
You must confirm the deletion.
----
6. Click Next to continue.
Once you proceed to the next page, you cannot go back to change any of these cluster details.
6. Choose additional Operators to install on the Operators page:
1. If you want to install an Operator bundle, select an option in the Bundles section.
2. If you want to install only some Operators, select the individual Operators from the Single Operators section.
3. Click Next to continue.
7. Upload an SSH public key and generate the Discovery ISO:
1. Click the Add Hosts button in the Host Discovery page.
2. Upload an SSH public key in the SSH public key section so that you can connect to the cluster nodes as the core user.
If you do not already have an SSH public key, see "Generating a key pair for cluster node SSH access" for more information.
3. Select Show proxy settings.
4. Enter values for the HTTP proxy URL, HTTPS URL proxy, and No proxy domains fields.
5. Click Generate Discovery ISO.
8. Copy the command from the Command to download the ISO field and run the command as a root user in the ODA environment.
Example command

```terminal
# wget -O discovery_image_example.iso 'https://api.openshift.com/api/assisted-images/bytoken/eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJleHAiOjE3Njg0Mjc3MDIsInN1YiI6ImNhMzZjZWU1LTQ3ZWEtNDc0Ny05OTg5LTVhZTYyMmMzMjZlNSJ9.jl-HvaxBR-WX73vpxO-Fy65bmY-RE5iL6AqL0wbWCmE/4.20/x86_64/minimal.iso'
```


* Generating a key pair for cluster node SSH access

# Creating nodes in the Oracle Database Appliance environment

After generating and downloading the Discovery ISO to your Oracle Database Appliance (ODA) environment, create control plane nodes and worker nodes in the environment.

1. Run the script to create control plane nodes as described in section 3.4 of the Red Hat Red Hat OpenShift Container Platform on Oracle Database Appliance Deployment Guide (Oracle documentation).
2. Run the script to create worker nodes as described in section 3.5 of the "Red Hat Red Hat OpenShift Container Platform on Oracle Database Appliance Deployment Guide".
3. Update the MAC address for each node as described in section 3.6 of the "Red Hat Red Hat OpenShift Container Platform on Oracle Database Appliance Deployment Guide".

# Completing host discovery and starting cluster installation

After preparing control plane and worker nodes in the Oracle Database Appliance (ODA) environment, complete host discovery and initiate the cluster installation.

As you create hosts using the provided scripts, the hosts begin to appear in the table of the Host Discovery page, where you can configure the hosts as needed.

1. Go to the Host Discovery page.
2. Assign host roles in the Host Inventory table:
1. In the Role column of the table, expand the Auto-Assign arrow for the host.
2. Assign the host with either a Control Plane node or a Worker role.
3. Repeat this process for each host in the table.
3. Click Next.
4. On the Storage page, verify storage details and configure host storage as needed.
5. Click Next.
6. Configure networking details on the Networking page:
1. Select User-Managed Networking as the Network Management type.
2. Select Host SSH Public Key for troubleshooting after installation to connect to hosts using a public SSH key for troubleshooting after installation.
7. Click Next.
8. Validate cluster details on the Review and create page.
9. Click Install cluster to begin the installation.
10. Monitor installation progress and wait for all nodes to reach a Ready state.

# Completing the installation

After the cluster is installed and initialized, the Assisted Installer indicates that the installation is finished. The Assisted Installer provides the console URL, the kubeadmin username and password, and the kubeconfig file.

* You have installed the OpenShift CLI (`oc`).

1. Make a copy of the kubeadmin username and password.
2. Download the kubeconfig file and copy it to the auth directory under your working directory by running the following commands:

```terminal
$ mkdir -p <working_directory>/auth
```


```terminal
$ cp kubeconfig <working_directory>/auth
```


[NOTE]
----
The kubeconfig file is available for download for 20 days after completing the installation.
----
3. Add the kubeconfig file to your environment by running the following command:

```terminal
$ export KUBECONFIG=<working_directory>/auth/kubeconfig
```

4. Log in with the OpenShift CLI (`oc`) by running the following command:

```terminal
$ oc login -u kubeadmin -p <password>
```


Replace <password> with the password of the kubeadmin user.
5. Click the web console URL or click Launch OpenShift Console to open the console.
6. Enter the kubeadmin username and password. Follow the instructions in the Red Hat OpenShift Container Platform console to configure an identity provider and configure alert receivers.