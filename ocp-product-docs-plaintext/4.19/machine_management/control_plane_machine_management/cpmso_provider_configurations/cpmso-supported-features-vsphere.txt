# Configuring VMware vSphere features for control plane machines


You can enable or change the configuration of features for your control plane machines by editing values in the control plane machine set specification.
When you save an update to the control plane machine set, the Control Plane Machine Set Operator updates the control plane machines according to your configured update strategy.
For more information, see "Updating the control plane configuration".

# Adding tags to machines by using machine sets

Red Hat OpenShift Container Platform adds a cluster-specific tag to each virtual machine (VM) that it creates.
The installation program uses these tags to select the VMs to delete when uninstalling a cluster.

In addition to the cluster-specific tags assigned to VMs, you can configure a machine set to add up to 10 additional vSphere tags to the VMs it provisions.

* You have access to an Red Hat OpenShift Container Platform cluster installed on vSphere using an account with cluster-admin permissions.
* You have access to the VMware vCenter console associated with your cluster.
* You have created a tag in the vCenter console.
* You have installed the OpenShift CLI (`oc`).

1. Use the vCenter console to find the tag ID for any tag that you want to add to your machines:
1. Log in to the vCenter console.
2. From the Home menu, click Tags & Custom Attributes.
3. Select a tag that you want to add to your machines.
4. Use the browser URL for the tag that you select to identify the tag ID.
Example tag URL

```text
https://vcenter.example.com/ui/app/tags/tag/urn:vmomi:InventoryServiceTag:208e713c-cae3-4b7f-918e-4051ca7d1f97:GLOBAL/permissions
```

Example tag ID

```text
urn:vmomi:InventoryServiceTag:208e713c-cae3-4b7f-918e-4051ca7d1f97:GLOBAL
```

2. In a text editor, open the YAML file for an existing machine set or create a new one.
3. Edit the following lines under the providerSpec field:

```yaml
apiVersion: machine.openshift.io/v1
kind: ControlPlaneMachineSet
# ...
spec:
  template:
    spec:
      providerSpec:
        value:
          tagIDs: 1
          - <tag_id_value> 2
# ...
```

Specify a list of up to 10 tags to add to the machines that this machine set provisions.
Specify the value of the tag that you want to add to your machines.
For example, urn:vmomi:InventoryServiceTag:208e713c-cae3-4b7f-918e-4051ca7d1f97:GLOBAL.

# Configuring data disks by using machine sets

Red Hat OpenShift Container Platform clusters on VMware vSphere support adding up to 29 disks to the virtual machine (VM) controller.


[IMPORTANT]
----
{FeatureName} is a Technology Preview feature only. Technology Preview features are not supported with Red Hat production service level agreements (SLAs) and might not be functionally complete. Red Hat does not recommend using them in production. These features provide early access to upcoming product features, enabling customers to test functionality and provide feedback during the development process.
For more information about the support scope of Red Hat Technology Preview features, see Technology Preview Features Support Scope.
----

By configuring data disks, you can attach disks to VMs and use them to store data for etcd, container images, and other uses.
Separating data can help avoid filling the primary disk so that important activities such as upgrades have the resources that they require.


[NOTE]
----
Adding data disks attaches them to the VM and mounts them to the location that RHCOS designates.
----

* You have administrator access to OpenShift CLI (`oc`) for an Red Hat OpenShift Container Platform cluster on vSphere.

1. In a text editor, open the YAML file for an existing machine set or create a new one.
2. Edit the following lines under the providerSpec field:

```yaml
apiVersion: machine.openshift.io/v1
kind: ControlPlaneMachineSet
# ...
spec:
  template:
    machines_v1beta1_machine_openshift_io:
      spec:
        providerSpec:
          value:
            dataDisks: 1
            - name: "<disk_name>" 2
              provisioningMode: "<mode>" 3
              sizeGiB: 20 4
            - name: "<disk_name>"
              provisioningMode: "<mode>"
              sizeGiB: 20
# ...
```

Specify a collection of 1-29 data disk definitions.
This sample configuration shows the formatting to include two data disk definitions.
Specify the name of the data disk.
The name must meet the following requirements:
* Start and end with an alphanumeric character
* Consist only of alphanumeric characters, hyphens (-), and underscores (_)
* Have a maximum length of 80 characters
Specify the data disk provisioning method.
This value defaults to the vSphere default storage policy if not set.
Valid values are Thin, Thick, and EagerlyZeroed.
Specify the size of the data disk in GiB.
The maximum size is 16384 GiB.

# Additional resources

* Updating the control plane configuration
* Changing control plane configuration options for VMware vSphere