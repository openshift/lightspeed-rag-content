# Configuring an Ingress Controller for manual DNS Management


To ensure application accessiblity across external networks in Red Hat OpenShift Container Platform, you can manually configure DNS records for an Ingress Controller.
As a cluster administrator, when you create an Ingress Controller, the Operator manages the DNS records automatically. This has some limitations when the required DNS zone is different from the cluster DNS zone or when the DNS zone is hosted outside the cloud provider.
The following list details key aspects for a managed DNS management policy:
* The Managed DNS management policy for Ingress Controllers ensures that the lifecycle of the wildcard DNS record on the cloud provider is automatically managed by the Operator. This is the default behavior.
* When you change an Ingress Controller from Managed to Unmanaged DNS management policy, the Operator does not clean up the previous wildcard DNS record provisioned on the cloud.
* When you change an Ingress Controller from Unmanaged to Managed DNS management policy, the Operator attempts to create the DNS record on the cloud provider if it does not exist or updates the DNS record if it already exists.
The following list details key aspects for a unmanaged DNS management policy:
* The Unmanaged DNS management policy for Ingress Controllers ensures that the lifecycle of the wildcard DNS record on the cloud provider is not automatically managed; instead, it becomes the responsibility of the cluster administrator.

# Creating a custom Ingress Controller with the Unmanaged DNS management policy

As a cluster administrator, you can create a new custom Ingress Controller with the Unmanaged DNS management policy.

* Install the OpenShift CLI (oc).
* Log in as a user with cluster-admin privileges.

1. Create a custom resource (CR) file named sample-ingress.yaml containing the following:

```yaml
apiVersion: operator.openshift.io/v1
kind: IngressController
metadata:
  namespace: openshift-ingress-operator
  name: <name>
spec:
  domain: <domain>
  endpointPublishingStrategy:
    type: LoadBalancerService
    loadBalancer:
      scope: External
      dnsManagementPolicy: Unmanaged
```


where:
metadata.name:: Specify the <name> with a name for the IngressController object.
spec.domain:: Specify the domain based on the DNS record that was created as a prerequisite.
loadBalancer.scope:: Specify the scope as External to expose the load balancer externally.
loadBalancer.dnsManagementPolicy: Specifies if the Ingress Controller is managing the lifecycle of the wildcard DNS record associated with the load balancer. The valid values are Managed and Unmanaged. The default value is Managed.
2. Save the file to apply the changes.

```terminal
oc apply -f <name>.yaml 1
```


Inspect the output and confirm that dnsManagementPolicy is set to Unmanaged.

# Modifying an existing Ingress Controller

As a cluster administrator, you can modify an existing Ingress Controller to manually manage the DNS record lifecycle.

* Install the OpenShift CLI (oc).
* Log in as a user with cluster-admin privileges.

1. Modify the chosen IngressController to set dnsManagementPolicy:

```terminal
SCOPE=$(oc -n openshift-ingress-operator get ingresscontroller <name> -o=jsonpath="{.status.endpointPublishingStrategy.loadBalancer.scope}")
```


```terminal
oc -n openshift-ingress-operator patch ingresscontrollers/<name> --type=merge --patch='{"spec":{"endpointPublishingStrategy":{"type":"LoadBalancerService","loadBalancer":{"dnsManagementPolicy":"Unmanaged", "scope":"${SCOPE}"}}}}'
```

2. Optional: You can delete the associated DNS record in the cloud provider.

# Additional resources

* Ingress Controller configuration parameters